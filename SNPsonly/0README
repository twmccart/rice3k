These files were generated by running `cat phas_cultivars | parallel -j 80% src/extract_SNPs.karst {}` in ../calls on karst.

find . -name "*.onlySNPs.annotated.vcf" -print0 | parallel -0 -j 80% cat {} '|' ./countSNPsperpromoter.awk '>' {.}.promoterSNPcounts.tsv
find . -name "*.onlySNPs.annotated.vcf" -print0 | parallel -0 -j 80% cat {} '|' ./countSNPspergene.awk '>' {.}.geneSNPcounts.tsv

for file in *.geneSNPcounts.tsv; do echo -n "${file%%.*} " >> averageSNPspergene.tsv; awk ' BEGIN {OFS=""} {sum+=$2} END {print "average", sum/NR}' $file >> averageSNPspergene.tsv; done

for file in *.promoterSNPcounts.tsv; do echo -n "${file%%.*} " >> averageSNPsperpromoter.tsv; tail -n 1 $file >> averageSNPsperpromoter.tsv; done

for file in *.geneSNPcounts.tsv; do awk 'FNR==NR{lengtharray[$4]=$3-$2+1;next}{normal=$2/lengtharray[$1]}{sum+=normal}{print $1 FS normal} END {print "average="sum/FNR}' <(gunzip -c ../reference/20cultivars.genes.gz) $file > ${file%.geneSNPcount.tsv}.normalizedgeneSNPcount.tsv; done
